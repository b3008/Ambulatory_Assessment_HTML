{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/aa-baseElement/baseElement.js","webpack:///./src/aa-holder/aa-holder.js","webpack:///./src/aa-choose/aa-choose.js","webpack:///./src/lib/jsep/jsep.js","webpack:///./src/aa-choose/aa-when/aa-when.js","webpack:///./src/aa-choose/aa-otherwise/aa-otherwise.js","webpack:///(webpack)/buildin/harmony-module.js","webpack:///./src/aa-variable/aa-variable.js","webpack:///./src/aa-function/aa-function-random.js","webpack:///./src/aa-memory/aa-memory.js","webpack:///./src/aa-screen/aa-screen.js","webpack:///./src/aa-sequence/aa-jump/aa-jump.js","webpack:///./src/aa-sequence/aa-sequence.js","webpack:///./src/aa-session/aa-session.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","window","html","txt","val","result","length","BaseElement","HTMLElement","super","this","_props","makePropertiesFromAttributes","console","log","tagName","_attachedTimestamp","Date","getTime","_debug","debug","attr","customElements","toLowerCase","observedAttributes","props","prop","toCamelCase","getAttribute","set","setAttribute","str","words","split","toUpperCase","substr","letter","node","AANodeNames","indexOf","nodeName","element","childNodes","child","restoreNode","_restoreHeldNodes","fragment","document","createDocumentFragment","append","cloneNode","nodeCopy","clone","isAAElement","innerFragment","_createFragmentForNode","detail","dispatchEvent","CustomEvent","bubbles","_sessionElement","parentNode","push","define","AAHolder","holder","createElement","holdNode","scanAndReplace","content","createHolderForNode","replaceWith","scanAndRestore","restoreHeldNode","id","appendChild","holdsAAElement","AAChoose","root","attachShadow","innerHTML","originalContent","_shouldRun","shouldRun","sessionElement","_getParentSession","nodes","_getNodeToInstantiate","_dispatchEndEvent","started","nodesToReturn","nodeOtherwise","myFragmentChildren","isChildTrue","children","evaluate","copy","fragmentChildrenCounter","finalFragmentChild","currentNode","formerNodes","fragmentChild","isHolder","replaceHolderWithElement","test","evaluateTestExpression","expr","replaceExpressionIdentifiersWithValues","parseTree","left","type","right","eval","e","error","expression","session","originalIdentifiers","keys","getDataDump","upperCaseIdentifiers","map","getData","finalValue","parseInt","RegExp","replace","throwError","message","index","Error","description","unary_ops","binary_ops","getMaxKeyLen","obj","len","max_len","max_unop_len","max_binop_len","literals","binaryPrecedence","op_val","createBinaryExpression","operator","isDecimalDigit","ch","isIdentifierStart","String","fromCharCode","isIdentifierPart","jsep","ch_i","charAtFunc","charAt","charCodeAtFunc","charCodeAt","exprI","exprICode","gobbleSpaces","gobbleExpression","consequent","alternate","gobbleBinaryExpression","gobbleBinaryOp","to_check","tc_len","biop","prec","stack","biop_info","gobbleToken","pop","gobbleNumericLiteral","gobbleStringLiteral","gobbleArray","argument","prefix","gobbleVariable","chCode","number","parseFloat","raw","quote","closed","gobbleIdentifier","identifier","start","slice","gobbleArguments","termination","args","gobbleGroup","computed","callee","elements","body","version","toString","addUnaryOp","op_name","Math","max","addBinaryOp","precedence","addLiteral","literal_name","literal_value","removeUnaryOp","removeAllUnaryOps","removeBinaryOp","removeAllBinaryOps","removeLiteral","removeAllLiterals","old_jsep","noConflict","parse","AAWhen","AAOtherwise","_replaceChildNodesWithHolderElements","originalModule","webpackPolyfill","setData","getValue","parsedMin","min","parsedMax","getRandomInt","ceil","floor","random","dataset","toHyphenated","connectedCallback","submitButtonText","_submitButtonText","css","_started","submitButtonHidden","querySelector","style","display","addEventListener","submitButtonClick","emaChildren","getEmaChildren","demandsResponse","displayAttention","userMessage","color","$","hasChildrenThatDemandResponse","valueSubmitEvent","callback","dontHide","hide","getName","attachedTimestamp","getChildrenValues","isEmaElement","automate","goto","endEventListener","init","Boolean","reflectToAttribute","reflectToConfig","showNextButton","nextKeyCode","Number","prevKeyCode","displayAll","writeInto","target","warn","restoreHeldNodes","sIndex","formerIndex","nextCalls","nextIndex","stopped","nextWithTimeout","hasNext","setTimeout","next","nextParam","counter","nodeType","Node","ELEMENT_NODE","fragmentChildCopy","stopPropagation","_mem","myTemplate","input","data","sessionID","sessionTimestamp","sessionTime","sessionName","variables","saveReplyValue","inputSubmitEvent","sessionEndEvent","myIdGenerator","sessionDatum","run","templateClone","remove","myTemplateClone","attachTemplateChildNodesToMyself","aaCustomElements","AAMemory","AAScreen","AASequence","AASession","AAVariable"],"mappings":"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","file":"aaCustomElements.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","\n\n\nvar html = function (txt, ...val) {\n\n    let result = txt[0];\n    for (let i = 0; i < val.length; i++) {\n        result += val[i];\n        result += txt[i + 1];\n    }\n    return result;\n}\n\nif(window) window.html = html;\n\nexport default class BaseElement extends HTMLElement {\n\n\n    constructor() {\n        super();\n        this._props = this.makePropertiesFromAttributes();\n    }\n\n    connectedCallback() {\n        console.log(this.tagName, \" connected\");\n        this._attachedTimestamp = new Date().getTime();\n        this._debug = (this.debug===true)||(this.debug===null);\n    }\n\n\n    makePropertiesFromAttributes() {\n        \n        let ElementClass = customElements.get(this.tagName.toLowerCase());\n\n        let attr = ElementClass.observedAttributes;\n        if (!attr) return null;\n        let props = {};\n        for (let i = 0; i < attr.length; i++) {\n            let prop = this.toCamelCase(attr[i]);\n            props[prop] = attr[i];\n\n\n            if (typeof this[prop] != 'undefined') {\n                continue;\n            } else {\n                \n                Object.defineProperty(this, prop, {\n                    get: () => {\n                     \n                        let result = this.getAttribute(attr[i]);\n                        if (result === 'true') { return true; }\n                        else if (result === 'false') { return false; }\n                        else { return result; }\n                    },\n                    set: (value) => {\n                        this.setAttribute(attr[i], value);\n                    }\n                });\n            }\n        }\n        return props;\n    }\n\n    // setAttributes(){\n    //     let propKeys = Object.keys(this._props)\n    //     for(let i=0; i<propKeys.length; i++){\n    //         let p = this._propKeys[i];\n    //         if(this[p]){\n    //             this.setAttribute(this._props[p])\n    //         }\n    //     }\n    // }\n    toCamelCase(str) {\n        let words = str.split('-');\n        let result = words[0];\n        for (let i = 1; i < words.length; i++) {\n            result += words[i][0].toUpperCase() + words[i].substr(1);\n        }\n        return result;\n    }\n\n    toHyphenated(str) {\n        let result = '';\n        for (let i = 0; i < str.length; i++) {\n            let letter = str[i];\n            if (letter.toLowerCase() !== letter) {\n                // letter is uppercase\n                result += `-${letter.toLowerCase()}`;\n            } else {\n                result += letter;\n            }\n        }\n        return result;\n    }\n\n\n\n\n    static isAAElement(node) {\n        if (AANodeNames.indexOf(node.nodeName) != -1) {\n            return true;\n        }\n        return false;\n    }\n\n\n\n    _restoreHeldNodes(element) {\n        \n        console.log(\"restoring\", element)\n        let childNodes = element.childNodes;\n        for (let i = 0; i < childNodes.length; i++) {\n            let child = childNodes[i];\n            if (child.nodeName=='AA-HOLDER') {\n                child.restoreNode();\n            }\n            else if (child.childNodes.length > 0) {\n                this._restoreHeldNodes(child);\n            } \n        }\n    }\n\n\n    \n   \n\n    _createFragmentForNode(node) {\n        let fragment = document.createDocumentFragment();\n        //  first get references to the children,\n        //  because the element.children array will be modified as they are appended to the fragment\n        let childNodes = [];\n        for(let i=0; i<node.childNodes.length; i++){\n            fragment.append(node.childNodes[i].cloneNode(true));\n        }\n        return fragment;\n    }\n\n\n    copy(node){\n        let nodeCopy;\n        if (node.nodeName == \"AA-HOLDER\") {\n            nodeCopy = node.clone();\n        } else if (BaseElement.isAAElement(node)) {\n            nodeCopy = node.cloneNode();\n            nodeCopy.innerFragment = this._createFragmentForNode(node);\n        }\n        else {\n            nodeCopy = node.cloneNode(true);\n        }\n        return nodeCopy;\n    }\n\n\n    _dispatchDebugEvent(detail) {\n        if (this.debug) {\n            this.dispatchEvent(new CustomEvent('debugEvent', { detail, bubbles:true }));\n        }\n    }\n\n    \n\n    _dispatchEndEvent(detail) {\n        this.dispatchEvent(new CustomEvent('endEvent', { bubbles: true, detail }));\n    }\n\n    _getParentSession(){\n        let _sessionElement = this;\n        while ((_sessionElement != null) && (_sessionElement.nodeName != 'AA-SESSION')) {\n            _sessionElement = _sessionElement.parentNode;\n        }\n        return _sessionElement;\n    }\n\n}\n\n\nif (!customElements.get('aa-base-element')) {\n    window.AANodeNames = window.AANodeNames || [];\n    window.AANodeNames.push('AA-BASE-ELEMENT');\n    customElements.define('aa-base-element', BaseElement);\n}\n","import BaseElement from './../aa-baseElement/baseElement.js'\nexport default class AAHolder extends BaseElement {\n\n\n    // static holderInstances = [];\n    static get observedAttributes() {\n        return [\"name\"];\n    }\n\n    static createHolderForNode(node) {\n        let holder = document.createElement(\"aa-holder\");\n        holder.holdNode(node);\n        // AAHolder.holderInstances.push(holder);\n        return holder;\n\n    }\n\n\n    static scanAndReplace(node) {\n        if (node.nodeName == \"TEMPLATE\") {\n            AAHolder.scanAndReplace(node.content);\n        }\n        else if (BaseElement.isAAElement(node)) {\n            let holder = AAHolder.createHolderForNode(node);\n            node.replaceWith(holder);\n        } else\n            for (let i = 0; i < node.childNodes.length; i++) {\n                AAHolder.scanAndReplace(node.childNodes[i]);\n            }\n\n    }\n\n    static scanAndRestore(node) {\n\n        if (node.nodeName == \"TEMPLATE\") AAHolder.scanAndRestore(node.content);\n        else if (BaseElement.isAAElement(node)) {\n            if (node.nodeName == \"AA-HOLDER\") {\n                node.restoreHeldNode();\n            }\n        }\n        else for (let i = 0; i < node.childNodes.length; i++) {\n            AAHolder.scanAndRestore(node.childNodes[i]);\n        }\n\n    }\n\n    clone(){\n        let clone = document.createElement('aa-holder');\n        clone.name = this.name;\n        clone.id = this.id;\n        clone.node = this.node.cloneNode(true);\n        clone.innerFragment =   document.createDocumentFragment();        \n        for(let i=0; i<this.innerFragment.childNodes.length; i++){\n            clone.innerFragment.appendChild(this.innerFragment.childNodes[i].cloneNode(true));\n        }\n        clone.holdsAAElement = this.holdsAAElement;\n        return clone;\n    }\n\n    constructor() {\n        super();\n    }\n\n\n\n    holdNode(o) {\n        this.node = o.cloneNode(false);\n\n        if (o.id) {\n            this.id = o.id;\n        }\n        else {\n            this.id = o.nodeName;\n        }\n        this.innerFragment = this._createFragmentForNode(o);\n        this.holdsAAElement = BaseElement.isAAElement(o);\n    }\n\n\n\n\n    replace(node) {\n        node.replaceWith(this);\n    }\n\n    restoreHeldNode() {\n\n        if (this.node) {\n            if (!this.holdsAAElement) {\n                while (this.innerFragment.childNodes.length) {\n\n                    this.node.appendChild(this.innerFragment.childNodes[0]);\n                }\n\n            } else if (this.holdsAAElement) {\n                this.node.innerFragment = this.innerFragment;\n            }\n            this.replaceWith(this.node);\n        }\n    }\n\n\n\n    connectedCallback() {\n    }\n\n\n\n}\n\n\nif (!customElements.get('aa-holder')) {\n    window.AANodeNames = window.AANodeNames || [];\n    window.AANodeNames.push('AA-HOLDER');\n    customElements.define('aa-holder', AAHolder);\n}\n","import BaseElement from './../aa-baseElement/baseElement.js';\nimport './aa-when/aa-when.js';\nimport './aa-otherwise/aa-otherwise.js';\n\n\nimport jsep from './../lib/jsep/jsep.js';\nexport default class AAChoose extends BaseElement {\n\n    static get observedAttributes() {\n        return ['name', 'should-run', 'debug'];\n    }\n\n    constructor() {\n        super();\n        this.root = this.attachShadow({ mode: 'open' });\n        this.root.innerHTML = \"<slot></slot>\"\n        this.originalContent = this.innerHTML;\n    }\n\n    _restoreOriginalContent(){\n\n    }\n    connectedCallback() {\n        \n        this._shouldRun = (this.shouldRun === null) || (this.shouldRun === true);\n        this.sessionElement = this._getParentSession();\n        \n      \n        if (this._shouldRun) {\n            if (typeof this.innerFragment !== 'undefined') {\n                \n                let nodes = this._getNodeToInstantiate();\n                if (nodes.length == 0) {\n                    this._dispatchEndEvent();\n                } else {\n                    for (let i = 0; i < nodes.length; i++) {\n                        let node = nodes[i];\n                        if (typeof node!== 'undefined') {\n                            this.appendChild(node);\n                            // this._restoreHeldNodes(this);\n                        }\n                       \n                    }\n                    this._dispatchEndEvent();\n                }\n            }\n            else {\n                // this._restoreHeldNodes(this);\n                if (this.childNodes.length == 0) {\n                    this._dispatchEndEvent();\n                }\n            }\n        }\n    }\n\n    _getNodeToInstantiate() {\n\n        \n        this.started = true;\n        let nodesToReturn = [];\n        let nodeOtherwise = [];\n\n        this.myFragmentChildren = [];\n        let isChildTrue = false;\n        for (let i = 0; i < this.innerFragment.children.length; i++) {\n\n            let child = this.innerFragment.children[i];\n\n            this.myFragmentChildren.push(child)\n            // if (child.nodeName==='AA-HOLDER') {\n                \n            if (child.nodeName == 'AA-WHEN') {\n                    isChildTrue = this.evaluate(child);\n                    if (isChildTrue) {\n                        nodesToReturn.push(this.copy(child))\n                        // return child;\n                    };\n                }\n\n                if (child.nodeName == 'AA-OTHERWISE') {\n                    //we reached otherwise, should we stop and attach it?\n                    // /return child;\n                    nodeOtherwise.push(this.copy(child))\n                }\n            // }\n        }\n\n        if (nodesToReturn.length == 0) {\n            return nodeOtherwise;\n        }\n        else {\n            return nodesToReturn;\n        }\n\n    }\n\n    run() {\n        this.started = true;\n        if (this.myFragmentChildren.length === 0) return;\n        if (this.fragmentChildrenCounter >= this.myFragmentChildren.length) return;\n        if (!this.currentNode) { this.formerNodes.push(this.currentNode); }\n\n        let finalFragmentChild;\n        let fragmentChild = this.myFragmentChildren[this.fragmentChildrenCounter];\n        if (this.isHolder(fragmentChild)) {\n            finalFragmentChild = this.replaceHolderWithElement(fragmentChild);\n        }\n        else {\n            finalFragmentChild = fragmentChild;\n        }\n        this.appendChild(finalFragmentChild);\n        this._restoreHeldNodes(finalFragmentChild);\n        this.fragmentChildrenCounter += 1;\n    }\n\n    evaluate(element) {\n\n        let test = element.getAttribute('test');\n        if ((test == null) || (test == '')) return null;\n        return this.evaluateTestExpression(test);\n        \n    }\n\n    evaluateTestExpression(test) {\n\n        let expr = this.replaceExpressionIdentifiersWithValues(test);\n        // after replacing known variable names with their values in the string, test to see if the expression can be parsed\n        try {\n            var parseTree = jsep(expr);\n            if ((parseTree.left.type == \"Literal\") && (parseTree.right.type == \"Literal\")) {\n                return eval(expr);\n            } \n            else {\n              // there are still strings in the expression, which are unknown, an exception should be raised\n              throw \"unknown identifiers in expression : \" + expr;\n            }\n\n        } catch (e) {\n            console.error(\"parse error:\", e);\n        }\n\n    }\n\n\n    replaceExpressionIdentifiersWithValues(expression){\n        let session = this._getParentSession();\n         let result = expression.toUpperCase();\n        \n        let originalIdentifiers = Object.keys(session.getDataDump());\n        let upperCaseIdentifiers = originalIdentifiers.map(s=>s.toUpperCase());\n        for(let i in upperCaseIdentifiers)\n        {\n            let value = session.getData(originalIdentifiers[i]);\n            let finalValue = parseInt(value);\n            if(finalValue!=value) {\n                if(value===\"null\") { finalValue = `null`; }\n                else if(value===\"true\") {finalValue = \"true\";}\n                else if(value===\"false\") { finalValue = \"false\"}\n                else finalValue = `\"${value}\"`\n            }\n            let r = new RegExp(upperCaseIdentifiers[i], \"g\");\n            result = result.replace( r, finalValue );\n        }\n       return result;\n    }\n}\n\n\n\nif (!customElements.get('aa-choose')) {\n    window.AANodeNames = window.AANodeNames || [];\n    window.AANodeNames.push('AA-CHOOSE');\n    customElements.define('aa-choose', AAChoose);\n}\n","/**\r\n * this is a modified version of the original jsep \r\n * which if the root parameter is undefined,\r\n * the jsep object returned so as to be exported   \r\n **/ \r\n\r\n\r\n//     JavaScript Expression Parser (JSEP) 0.3.4\r\n//     JSEP may be freely distributed under the MIT License\r\n//     http://jsep.from.so/\r\n\r\n/*global module: true, exports: true, console: true */\r\nexport default (function (root) {\r\n\t'use strict';\r\n\t// Node Types\r\n\t// ----------\r\n\t\r\n\t// This is the full set of types that any JSEP node can be.\r\n\t// Store them here to save space when minified\r\n\tvar COMPOUND = 'Compound',\r\n\t\tIDENTIFIER = 'Identifier',\r\n\t\tMEMBER_EXP = 'MemberExpression',\r\n\t\tLITERAL = 'Literal',\r\n\t\tTHIS_EXP = 'ThisExpression',\r\n\t\tCALL_EXP = 'CallExpression',\r\n\t\tUNARY_EXP = 'UnaryExpression',\r\n\t\tBINARY_EXP = 'BinaryExpression',\r\n\t\tLOGICAL_EXP = 'LogicalExpression',\r\n\t\tCONDITIONAL_EXP = 'ConditionalExpression',\r\n\t\tARRAY_EXP = 'ArrayExpression',\r\n\r\n\t\tPERIOD_CODE = 46, // '.'\r\n\t\tCOMMA_CODE  = 44, // ','\r\n\t\tSQUOTE_CODE = 39, // single quote\r\n\t\tDQUOTE_CODE = 34, // double quotes\r\n\t\tOPAREN_CODE = 40, // (\r\n\t\tCPAREN_CODE = 41, // )\r\n\t\tOBRACK_CODE = 91, // [\r\n\t\tCBRACK_CODE = 93, // ]\r\n\t\tQUMARK_CODE = 63, // ?\r\n\t\tSEMCOL_CODE = 59, // ;\r\n\t\tCOLON_CODE  = 58, // :\r\n\r\n\t\tthrowError = function(message, index) {\r\n\t\t\tvar error = new Error(message + ' at character ' + index);\r\n\t\t\terror.index = index;\r\n\t\t\terror.description = message;\r\n\t\t\tthrow error;\r\n\t\t},\r\n\r\n\t// Operations\r\n\t// ----------\r\n\r\n\t// Set `t` to `true` to save space (when minified, not gzipped)\r\n\t\tt = true,\r\n\t// Use a quickly-accessible map to store all of the unary operators\r\n\t// Values are set to `true` (it really doesn't matter)\r\n\t\tunary_ops = {'-': t, '!': t, '~': t, '+': t},\r\n\t// Also use a map for the binary operations but set their values to their\r\n\t// binary precedence for quick reference:\r\n\t// see [Order of operations](http://en.wikipedia.org/wiki/Order_of_operations#Programming_language)\r\n\t\tbinary_ops = {\r\n\t\t\t'||': 1, '&&': 2, '|': 3,  '^': 4,  '&': 5,\r\n\t\t\t'==': 6, '!=': 6, '===': 6, '!==': 6,\r\n\t\t\t'<': 7,  '>': 7,  '<=': 7,  '>=': 7,\r\n\t\t\t'<<':8,  '>>': 8, '>>>': 8,\r\n\t\t\t'+': 9, '-': 9,\r\n\t\t\t'*': 10, '/': 10, '%': 10\r\n\t\t},\r\n\t// Get return the longest key length of any object\r\n\t\tgetMaxKeyLen = function(obj) {\r\n\t\t\tvar max_len = 0, len;\r\n\t\t\tfor(var key in obj) {\r\n\t\t\t\tif((len = key.length) > max_len && obj.hasOwnProperty(key)) {\r\n\t\t\t\t\tmax_len = len;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn max_len;\r\n\t\t},\r\n\t\tmax_unop_len = getMaxKeyLen(unary_ops),\r\n\t\tmax_binop_len = getMaxKeyLen(binary_ops),\r\n\t// Literals\r\n\t// ----------\r\n\t// Store the values to return for the various literals we may encounter\r\n\t\tliterals = {\r\n\t\t\t'true': true,\r\n\t\t\t'false': false,\r\n\t\t\t'null': null\r\n\t\t},\r\n\t// Except for `this`, which is special. This could be changed to something like `'self'` as well\r\n\t\tthis_str = 'this',\r\n\t// Returns the precedence of a binary operator or `0` if it isn't a binary operator\r\n\t\tbinaryPrecedence = function(op_val) {\r\n\t\t\treturn binary_ops[op_val] || 0;\r\n\t\t},\r\n\t// Utility function (gets called from multiple places)\r\n\t// Also note that `a && b` and `a || b` are *logical* expressions, not binary expressions\r\n\t\tcreateBinaryExpression = function (operator, left, right) {\r\n\t\t\tvar type = (operator === '||' || operator === '&&') ? LOGICAL_EXP : BINARY_EXP;\r\n\t\t\treturn {\r\n\t\t\t\ttype: type,\r\n\t\t\t\toperator: operator,\r\n\t\t\t\tleft: left,\r\n\t\t\t\tright: right\r\n\t\t\t};\r\n\t\t},\r\n\t\t// `ch` is a character code in the next three functions\r\n\t\tisDecimalDigit = function(ch) {\r\n\t\t\treturn (ch >= 48 && ch <= 57); // 0...9\r\n\t\t},\r\n\t\tisIdentifierStart = function(ch) {\r\n\t\t\treturn (ch === 36) || (ch === 95) || // `$` and `_`\r\n\t\t\t\t\t(ch >= 65 && ch <= 90) || // A...Z\r\n\t\t\t\t\t(ch >= 97 && ch <= 122) || // a...z\r\n                    (ch >= 128 && !binary_ops[String.fromCharCode(ch)]); // any non-ASCII that is not an operator\r\n\t\t},\r\n\t\tisIdentifierPart = function(ch) {\r\n\t\t\treturn (ch === 36) || (ch === 95) || // `$` and `_`\r\n\t\t\t\t\t(ch >= 65 && ch <= 90) || // A...Z\r\n\t\t\t\t\t(ch >= 97 && ch <= 122) || // a...z\r\n\t\t\t\t\t(ch >= 48 && ch <= 57) || // 0...9\r\n                    (ch >= 128 && !binary_ops[String.fromCharCode(ch)]); // any non-ASCII that is not an operator\r\n\t\t},\r\n\r\n\t\t// Parsing\r\n\t\t// -------\r\n\t\t// `expr` is a string with the passed in expression\r\n\t\tjsep = function(expr) {\r\n\t\t\t// `index` stores the character number we are currently at while `length` is a constant\r\n\t\t\t// All of the gobbles below will modify `index` as we move along\r\n\t\t\tvar index = 0,\r\n\t\t\t\tcharAtFunc = expr.charAt,\r\n\t\t\t\tcharCodeAtFunc = expr.charCodeAt,\r\n\t\t\t\texprI = function(i) { return charAtFunc.call(expr, i); },\r\n\t\t\t\texprICode = function(i) { return charCodeAtFunc.call(expr, i); },\r\n\t\t\t\tlength = expr.length,\r\n\r\n\t\t\t\t// Push `index` up to the next non-space character\r\n\t\t\t\tgobbleSpaces = function() {\r\n\t\t\t\t\tvar ch = exprICode(index);\r\n\t\t\t\t\t// space or tab\r\n\t\t\t\t\twhile(ch === 32 || ch === 9 || ch === 10 || ch === 13) {\r\n\t\t\t\t\t\tch = exprICode(++index);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// The main parsing function. Much of this code is dedicated to ternary expressions\r\n\t\t\t\tgobbleExpression = function() {\r\n\t\t\t\t\tvar test = gobbleBinaryExpression(),\r\n\t\t\t\t\t\tconsequent, alternate;\r\n\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\tif(exprICode(index) === QUMARK_CODE) {\r\n\t\t\t\t\t\t// Ternary expression: test ? consequent : alternate\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\tconsequent = gobbleExpression();\r\n\t\t\t\t\t\tif(!consequent) {\r\n\t\t\t\t\t\t\tthrowError('Expected expression', index);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\t\tif(exprICode(index) === COLON_CODE) {\r\n\t\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\t\talternate = gobbleExpression();\r\n\t\t\t\t\t\t\tif(!alternate) {\r\n\t\t\t\t\t\t\t\tthrowError('Expected expression', index);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\ttype: CONDITIONAL_EXP,\r\n\t\t\t\t\t\t\t\ttest: test,\r\n\t\t\t\t\t\t\t\tconsequent: consequent,\r\n\t\t\t\t\t\t\t\talternate: alternate\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthrowError('Expected :', index);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn test;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Search for the operation portion of the string (e.g. `+`, `===`)\r\n\t\t\t\t// Start by taking the longest possible binary operations (3 characters: `===`, `!==`, `>>>`)\r\n\t\t\t\t// and move down from 3 to 2 to 1 character until a matching binary operation is found\r\n\t\t\t\t// then, return that binary operation\r\n\t\t\t\tgobbleBinaryOp = function() {\r\n\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\tvar biop, to_check = expr.substr(index, max_binop_len), tc_len = to_check.length;\r\n\t\t\t\t\twhile(tc_len > 0) {\r\n\t\t\t\t\t\t// Don't accept a binary op when it is an identifier.\r\n\t\t\t\t\t\t// Binary ops that start with a identifier-valid character must be followed\r\n\t\t\t\t\t\t// by a non identifier-part valid character\r\n\t\t\t\t\t\tif(binary_ops.hasOwnProperty(to_check) && (\r\n\t\t\t\t\t\t\t!isIdentifierStart(exprICode(index)) ||\r\n\t\t\t\t\t\t\t(index+to_check.length< expr.length && !isIdentifierPart(exprICode(index+to_check.length)))\r\n\t\t\t\t\t\t)) {\r\n\t\t\t\t\t\t\tindex += tc_len;\r\n\t\t\t\t\t\t\treturn to_check;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tto_check = to_check.substr(0, --tc_len);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// This function is responsible for gobbling an individual expression,\r\n\t\t\t\t// e.g. `1`, `1+2`, `a+(b*2)-Math.sqrt(2)`\r\n\t\t\t\tgobbleBinaryExpression = function() {\r\n\t\t\t\t\tvar ch_i, node, biop, prec, stack, biop_info, left, right, i;\r\n\r\n\t\t\t\t\t// First, try to get the leftmost thing\r\n\t\t\t\t\t// Then, check to see if there's a binary operator operating on that leftmost thing\r\n\t\t\t\t\tleft = gobbleToken();\r\n\t\t\t\t\tbiop = gobbleBinaryOp();\r\n\r\n\t\t\t\t\t// If there wasn't a binary operator, just return the leftmost node\r\n\t\t\t\t\tif(!biop) {\r\n\t\t\t\t\t\treturn left;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Otherwise, we need to start a stack to properly place the binary operations in their\r\n\t\t\t\t\t// precedence structure\r\n\t\t\t\t\tbiop_info = { value: biop, prec: binaryPrecedence(biop)};\r\n\r\n\t\t\t\t\tright = gobbleToken();\r\n\t\t\t\t\tif(!right) {\r\n\t\t\t\t\t\tthrowError(\"Expected expression after \" + biop, index);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstack = [left, biop_info, right];\r\n\r\n\t\t\t\t\t// Properly deal with precedence using [recursive descent](http://www.engr.mun.ca/~theo/Misc/exp_parsing.htm)\r\n\t\t\t\t\twhile((biop = gobbleBinaryOp())) {\r\n\t\t\t\t\t\tprec = binaryPrecedence(biop);\r\n\r\n\t\t\t\t\t\tif(prec === 0) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbiop_info = { value: biop, prec: prec };\r\n\r\n\t\t\t\t\t\t// Reduce: make a binary expression from the three topmost entries.\r\n\t\t\t\t\t\twhile ((stack.length > 2) && (prec <= stack[stack.length - 2].prec)) {\r\n\t\t\t\t\t\t\tright = stack.pop();\r\n\t\t\t\t\t\t\tbiop = stack.pop().value;\r\n\t\t\t\t\t\t\tleft = stack.pop();\r\n\t\t\t\t\t\t\tnode = createBinaryExpression(biop, left, right);\r\n\t\t\t\t\t\t\tstack.push(node);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnode = gobbleToken();\r\n\t\t\t\t\t\tif(!node) {\r\n\t\t\t\t\t\t\tthrowError(\"Expected expression after \" + biop, index);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstack.push(biop_info, node);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ti = stack.length - 1;\r\n\t\t\t\t\tnode = stack[i];\r\n\t\t\t\t\twhile(i > 1) {\r\n\t\t\t\t\t\tnode = createBinaryExpression(stack[i - 1].value, stack[i - 2], node);\r\n\t\t\t\t\t\ti -= 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn node;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// An individual part of a binary expression:\r\n\t\t\t\t// e.g. `foo.bar(baz)`, `1`, `\"abc\"`, `(a % 2)` (because it's in parenthesis)\r\n\t\t\t\tgobbleToken = function() {\r\n\t\t\t\t\tvar ch, to_check, tc_len;\r\n\r\n\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\tch = exprICode(index);\r\n\r\n\t\t\t\t\tif(isDecimalDigit(ch) || ch === PERIOD_CODE) {\r\n\t\t\t\t\t\t// Char code 46 is a dot `.` which can start off a numeric literal\r\n\t\t\t\t\t\treturn gobbleNumericLiteral();\r\n\t\t\t\t\t} else if(ch === SQUOTE_CODE || ch === DQUOTE_CODE) {\r\n\t\t\t\t\t\t// Single or double quotes\r\n\t\t\t\t\t\treturn gobbleStringLiteral();\r\n\t\t\t\t\t} else if (ch === OBRACK_CODE) {\r\n\t\t\t\t\t\treturn gobbleArray();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tto_check = expr.substr(index, max_unop_len);\r\n\t\t\t\t\t\ttc_len = to_check.length;\r\n\t\t\t\t\t\twhile(tc_len > 0) {\r\n\t\t\t\t\t\t// Don't accept an unary op when it is an identifier.\r\n\t\t\t\t\t\t// Unary ops that start with a identifier-valid character must be followed\r\n\t\t\t\t\t\t// by a non identifier-part valid character\r\n\t\t\t\t\t\t\tif(unary_ops.hasOwnProperty(to_check) && (\r\n\t\t\t\t\t\t\t\t!isIdentifierStart(exprICode(index)) ||\r\n\t\t\t\t\t\t\t\t(index+to_check.length < expr.length && !isIdentifierPart(exprICode(index+to_check.length)))\r\n\t\t\t\t\t\t\t)) {\r\n\t\t\t\t\t\t\t\tindex += tc_len;\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\ttype: UNARY_EXP,\r\n\t\t\t\t\t\t\t\t\toperator: to_check,\r\n\t\t\t\t\t\t\t\t\targument: gobbleToken(),\r\n\t\t\t\t\t\t\t\t\tprefix: true\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tto_check = to_check.substr(0, --tc_len);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (isIdentifierStart(ch) || ch === OPAREN_CODE) { // open parenthesis\r\n\t\t\t\t\t\t\t// `foo`, `bar.baz`\r\n\t\t\t\t\t\t\treturn gobbleVariable();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\t// Parse simple numeric literals: `12`, `3.4`, `.5`. Do this by using a string to\r\n\t\t\t\t// keep track of everything in the numeric literal and then calling `parseFloat` on that string\r\n\t\t\t\tgobbleNumericLiteral = function() {\r\n\t\t\t\t\tvar number = '', ch, chCode;\r\n\t\t\t\t\twhile(isDecimalDigit(exprICode(index))) {\r\n\t\t\t\t\t\tnumber += exprI(index++);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(exprICode(index) === PERIOD_CODE) { // can start with a decimal marker\r\n\t\t\t\t\t\tnumber += exprI(index++);\r\n\r\n\t\t\t\t\t\twhile(isDecimalDigit(exprICode(index))) {\r\n\t\t\t\t\t\t\tnumber += exprI(index++);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tch = exprI(index);\r\n\t\t\t\t\tif(ch === 'e' || ch === 'E') { // exponent marker\r\n\t\t\t\t\t\tnumber += exprI(index++);\r\n\t\t\t\t\t\tch = exprI(index);\r\n\t\t\t\t\t\tif(ch === '+' || ch === '-') { // exponent sign\r\n\t\t\t\t\t\t\tnumber += exprI(index++);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twhile(isDecimalDigit(exprICode(index))) { //exponent itself\r\n\t\t\t\t\t\t\tnumber += exprI(index++);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!isDecimalDigit(exprICode(index-1)) ) {\r\n\t\t\t\t\t\t\tthrowError('Expected exponent (' + number + exprI(index) + ')', index);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tchCode = exprICode(index);\r\n\t\t\t\t\t// Check to make sure this isn't a variable name that start with a number (123abc)\r\n\t\t\t\t\tif(isIdentifierStart(chCode)) {\r\n\t\t\t\t\t\tthrowError('Variable names cannot start with a number (' +\r\n\t\t\t\t\t\t\t\t\tnumber + exprI(index) + ')', index);\r\n\t\t\t\t\t} else if(chCode === PERIOD_CODE) {\r\n\t\t\t\t\t\tthrowError('Unexpected period', index);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\ttype: LITERAL,\r\n\t\t\t\t\t\tvalue: parseFloat(number),\r\n\t\t\t\t\t\traw: number\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Parses a string literal, staring with single or double quotes with basic support for escape codes\r\n\t\t\t\t// e.g. `\"hello world\"`, `'this is\\nJSEP'`\r\n\t\t\t\tgobbleStringLiteral = function() {\r\n\t\t\t\t\tvar str = '', quote = exprI(index++), closed = false, ch;\r\n\r\n\t\t\t\t\twhile(index < length) {\r\n\t\t\t\t\t\tch = exprI(index++);\r\n\t\t\t\t\t\tif(ch === quote) {\r\n\t\t\t\t\t\t\tclosed = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t} else if(ch === '\\\\') {\r\n\t\t\t\t\t\t\t// Check for all of the common escape codes\r\n\t\t\t\t\t\t\tch = exprI(index++);\r\n\t\t\t\t\t\t\tswitch(ch) {\r\n\t\t\t\t\t\t\t\tcase 'n': str += '\\n'; break;\r\n\t\t\t\t\t\t\t\tcase 'r': str += '\\r'; break;\r\n\t\t\t\t\t\t\t\tcase 't': str += '\\t'; break;\r\n\t\t\t\t\t\t\t\tcase 'b': str += '\\b'; break;\r\n\t\t\t\t\t\t\t\tcase 'f': str += '\\f'; break;\r\n\t\t\t\t\t\t\t\tcase 'v': str += '\\x0B'; break;\r\n\t\t\t\t\t\t\t\tdefault : str += ch;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tstr += ch;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(!closed) {\r\n\t\t\t\t\t\tthrowError('Unclosed quote after \"'+str+'\"', index);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\ttype: LITERAL,\r\n\t\t\t\t\t\tvalue: str,\r\n\t\t\t\t\t\traw: quote + str + quote\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Gobbles only identifiers\r\n\t\t\t\t// e.g.: `foo`, `_value`, `$x1`\r\n\t\t\t\t// Also, this function checks if that identifier is a literal:\r\n\t\t\t\t// (e.g. `true`, `false`, `null`) or `this`\r\n\t\t\t\tgobbleIdentifier = function() {\r\n\t\t\t\t\tvar ch = exprICode(index), start = index, identifier;\r\n\r\n\t\t\t\t\tif(isIdentifierStart(ch)) {\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrowError('Unexpected ' + exprI(index), index);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\twhile(index < length) {\r\n\t\t\t\t\t\tch = exprICode(index);\r\n\t\t\t\t\t\tif(isIdentifierPart(ch)) {\r\n\t\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tidentifier = expr.slice(start, index);\r\n\r\n\t\t\t\t\tif(literals.hasOwnProperty(identifier)) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: LITERAL,\r\n\t\t\t\t\t\t\tvalue: literals[identifier],\r\n\t\t\t\t\t\t\traw: identifier\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t} else if(identifier === this_str) {\r\n\t\t\t\t\t\treturn { type: THIS_EXP };\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttype: IDENTIFIER,\r\n\t\t\t\t\t\t\tname: identifier\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Gobbles a list of arguments within the context of a function call\r\n\t\t\t\t// or array literal. This function also assumes that the opening character\r\n\t\t\t\t// `(` or `[` has already been gobbled, and gobbles expressions and commas\r\n\t\t\t\t// until the terminator character `)` or `]` is encountered.\r\n\t\t\t\t// e.g. `foo(bar, baz)`, `my_func()`, or `[bar, baz]`\r\n\t\t\t\tgobbleArguments = function(termination) {\r\n\t\t\t\t\tvar ch_i, args = [], node, closed = false;\r\n\t\t\t\t\twhile(index < length) {\r\n\t\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\t\tch_i = exprICode(index);\r\n\t\t\t\t\t\tif(ch_i === termination) { // done parsing\r\n\t\t\t\t\t\t\tclosed = true;\r\n\t\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t} else if (ch_i === COMMA_CODE) { // between expressions\r\n\t\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnode = gobbleExpression();\r\n\t\t\t\t\t\t\tif(!node || node.type === COMPOUND) {\r\n\t\t\t\t\t\t\t\tthrowError('Expected comma', index);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\targs.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!closed) {\r\n\t\t\t\t\t\tthrowError('Expected ' + String.fromCharCode(termination), index);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn args;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Gobble a non-literal variable name. This variable name may include properties\r\n\t\t\t\t// e.g. `foo`, `bar.baz`, `foo['bar'].baz`\r\n\t\t\t\t// It also gobbles function calls:\r\n\t\t\t\t// e.g. `Math.acos(obj.angle)`\r\n\t\t\t\tgobbleVariable = function() {\r\n\t\t\t\t\tvar ch_i, node;\r\n\t\t\t\t\tch_i = exprICode(index);\r\n\r\n\t\t\t\t\tif(ch_i === OPAREN_CODE) {\r\n\t\t\t\t\t\tnode = gobbleGroup();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnode = gobbleIdentifier();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\tch_i = exprICode(index);\r\n\t\t\t\t\twhile(ch_i === PERIOD_CODE || ch_i === OBRACK_CODE || ch_i === OPAREN_CODE) {\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\tif(ch_i === PERIOD_CODE) {\r\n\t\t\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\t\t\tnode = {\r\n\t\t\t\t\t\t\t\ttype: MEMBER_EXP,\r\n\t\t\t\t\t\t\t\tcomputed: false,\r\n\t\t\t\t\t\t\t\tobject: node,\r\n\t\t\t\t\t\t\t\tproperty: gobbleIdentifier()\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t} else if(ch_i === OBRACK_CODE) {\r\n\t\t\t\t\t\t\tnode = {\r\n\t\t\t\t\t\t\t\ttype: MEMBER_EXP,\r\n\t\t\t\t\t\t\t\tcomputed: true,\r\n\t\t\t\t\t\t\t\tobject: node,\r\n\t\t\t\t\t\t\t\tproperty: gobbleExpression()\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\t\t\tch_i = exprICode(index);\r\n\t\t\t\t\t\t\tif(ch_i !== CBRACK_CODE) {\r\n\t\t\t\t\t\t\t\tthrowError('Unclosed [', index);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\t} else if(ch_i === OPAREN_CODE) {\r\n\t\t\t\t\t\t\t// A function call is being made; gobble all the arguments\r\n\t\t\t\t\t\t\tnode = {\r\n\t\t\t\t\t\t\t\ttype: CALL_EXP,\r\n\t\t\t\t\t\t\t\t'arguments': gobbleArguments(CPAREN_CODE),\r\n\t\t\t\t\t\t\t\tcallee: node\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\t\tch_i = exprICode(index);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn node;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Responsible for parsing a group of things within parentheses `()`\r\n\t\t\t\t// This function assumes that it needs to gobble the opening parenthesis\r\n\t\t\t\t// and then tries to gobble everything within that parenthesis, assuming\r\n\t\t\t\t// that the next thing it should see is the close parenthesis. If not,\r\n\t\t\t\t// then the expression probably doesn't have a `)`\r\n\t\t\t\tgobbleGroup = function() {\r\n\t\t\t\t\tindex++;\r\n\t\t\t\t\tvar node = gobbleExpression();\r\n\t\t\t\t\tgobbleSpaces();\r\n\t\t\t\t\tif(exprICode(index) === CPAREN_CODE) {\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrowError('Unclosed (', index);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// Responsible for parsing Array literals `[1, 2, 3]`\r\n\t\t\t\t// This function assumes that it needs to gobble the opening bracket\r\n\t\t\t\t// and then tries to gobble the expressions as arguments.\r\n\t\t\t\tgobbleArray = function() {\r\n\t\t\t\t\tindex++;\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\ttype: ARRAY_EXP,\r\n\t\t\t\t\t\telements: gobbleArguments(CBRACK_CODE)\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\r\n\t\t\t\tnodes = [], ch_i, node;\r\n\r\n\t\t\twhile(index < length) {\r\n\t\t\t\tch_i = exprICode(index);\r\n\r\n\t\t\t\t// Expressions can be separated by semicolons, commas, or just inferred without any\r\n\t\t\t\t// separators\r\n\t\t\t\tif(ch_i === SEMCOL_CODE || ch_i === COMMA_CODE) {\r\n\t\t\t\t\tindex++; // ignore separators\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Try to gobble each expression individually\r\n\t\t\t\t\tif((node = gobbleExpression())) {\r\n\t\t\t\t\t\tnodes.push(node);\r\n\t\t\t\t\t// If we weren't able to find a binary expression and are out of room, then\r\n\t\t\t\t\t// the expression passed in probably has too much\r\n\t\t\t\t\t} else if(index < length) {\r\n\t\t\t\t\t\tthrowError('Unexpected \"' + exprI(index) + '\"', index);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// If there's only one expression just try returning the expression\r\n\t\t\tif(nodes.length === 1) {\r\n\t\t\t\treturn nodes[0];\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttype: COMPOUND,\r\n\t\t\t\t\tbody: nodes\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t// To be filled in by the template\r\n\tjsep.version = '0.3.4';\r\n\tjsep.toString = function() { return 'JavaScript Expression Parser (JSEP) v' + jsep.version; };\r\n\r\n\t/**\r\n\t * @method jsep.addUnaryOp\r\n\t * @param {string} op_name The name of the unary op to add\r\n\t * @return jsep\r\n\t */\r\n\tjsep.addUnaryOp = function(op_name) {\r\n\t\tmax_unop_len = Math.max(op_name.length, max_unop_len);\r\n\t\tunary_ops[op_name] = t; return this;\r\n\t};\r\n\r\n\t/**\r\n\t * @method jsep.addBinaryOp\r\n\t * @param {string} op_name The name of the binary op to add\r\n\t * @param {number} precedence The precedence of the binary op (can be a float)\r\n\t * @return jsep\r\n\t */\r\n\tjsep.addBinaryOp = function(op_name, precedence) {\r\n\t\tmax_binop_len = Math.max(op_name.length, max_binop_len);\r\n\t\tbinary_ops[op_name] = precedence;\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * @method jsep.addLiteral\r\n\t * @param {string} literal_name The name of the literal to add\r\n\t * @param {*} literal_value The value of the literal\r\n\t * @return jsep\r\n\t */\r\n\tjsep.addLiteral = function(literal_name, literal_value) {\r\n\t\tliterals[literal_name] = literal_value;\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * @method jsep.removeUnaryOp\r\n\t * @param {string} op_name The name of the unary op to remove\r\n\t * @return jsep\r\n\t */\r\n\tjsep.removeUnaryOp = function(op_name) {\r\n\t\tdelete unary_ops[op_name];\r\n\t\tif(op_name.length === max_unop_len) {\r\n\t\t\tmax_unop_len = getMaxKeyLen(unary_ops);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * @method jsep.removeAllUnaryOps\r\n\t * @return jsep\r\n\t */\r\n\tjsep.removeAllUnaryOps = function() {\r\n\t\tunary_ops = {};\r\n\t\tmax_unop_len = 0;\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * @method jsep.removeBinaryOp\r\n\t * @param {string} op_name The name of the binary op to remove\r\n\t * @return jsep\r\n\t */\r\n\tjsep.removeBinaryOp = function(op_name) {\r\n\t\tdelete binary_ops[op_name];\r\n\t\tif(op_name.length === max_binop_len) {\r\n\t\t\tmax_binop_len = getMaxKeyLen(binary_ops);\r\n\t\t}\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * @method jsep.removeAllBinaryOps\r\n\t * @return jsep\r\n\t */\r\n\tjsep.removeAllBinaryOps = function() {\r\n\t\tbinary_ops = {};\r\n\t\tmax_binop_len = 0;\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * @method jsep.removeLiteral\r\n\t * @param {string} literal_name The name of the literal to remove\r\n\t * @return jsep\r\n\t */\r\n\tjsep.removeLiteral = function(literal_name) {\r\n\t\tdelete literals[literal_name];\r\n\t\treturn this;\r\n\t};\r\n\r\n\t/**\r\n\t * @method jsep.removeAllLiterals\r\n\t * @return jsep\r\n\t */\r\n\tjsep.removeAllLiterals = function() {\r\n\t\tliterals = {};\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t// In desktop environments, have a way to restore the old value for `jsep`\r\n\tif (typeof exports === 'undefined') {\r\n\r\n\t\tif(!root){\r\n\t\t\treturn  jsep;\r\n\t\t}\r\n\t\tvar old_jsep = root.jsep;\r\n\t\t// The star of the show! It's a function!\r\n\t\troot.jsep = jsep;\r\n\t\t// And a courteous function willing to move out of the way for other similarly-named objects!\r\n\t\tjsep.noConflict = function() {\r\n\t\t\tif(root.jsep === jsep) {\r\n\t\t\t\troot.jsep = old_jsep;\r\n\t\t\t}\r\n\t\t\treturn jsep;\r\n\t\t};\r\n\t} else {\r\n\t\t// In Node.JS environments\r\n\t\tif (typeof module !== 'undefined' && module.exports) {\r\n\t\t\texports = module.exports = jsep;\r\n\t\t} else {\r\n\t\t\texports.parse = jsep;\r\n\t\t}\r\n\t}\r\n}(this));\r\n","import BaseElement from './../../aa-baseElement/baseElement.js'\nimport AAHolder from './../../aa-holder/aa-holder.js'\nexport default class AAWhen extends BaseElement {\n\n    static get observedAttributes() {\n        return ['name', 'should-run', 'debug'];\n    }\n\n    constructor(){\n        super();\n        this.root = this.attachShadow({ mode: 'open' });\n        this.root.innerHTML = '<slot></slot>'\n    }\n    \n    connectedCallback(){\n        if(this.started) return;\n        this.started = true;\n        if(typeof this.innerFragment!=\"undefined\")\n        {\n            AAHolder.scanAndReplace(this.innerFragment);\n            this.appendChild(this.innerFragment);\n            this._restoreHeldNodes(this);\n        }\n    }\n}\n\n\n\nif (!customElements.get('aa-when')) {\n    window.AANodeNames = window.AANodeNames|| []; \n    window.AANodeNames.push(\"AA-WHEN\");\n    customElements.define('aa-when', AAWhen);\n}\n","import BaseElement from '../../aa-baseElement/baseElement.js';\n\nexport default class AAOtherwise extends BaseElement {\n\n    constructor() {\n        super();\n    }\n\n    connectedCallback() {\n        if (this.started) return;\n        this.started = true;\n        if (typeof this.innerFragment != \"undefined\") {\n            this._replaceChildNodesWithHolderElements(this.innerFragment);\n            this.appendChild(this.innerFragment);\n            this._restoreHeldNodes(this);\n        }\n     \n    }\n}\n\nif (!customElements.get('aa-otherwise')) {\n    window.AANodeNames = window.AANodeNames|| []; \n    window.AANodeNames.push('AA-OTHERWISE');\n    customElements.define('aa-otherwise', AAOtherwise);\n}","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","import BaseElement from './../aa-baseElement/baseElement.js'\nexport default class AAVariable extends BaseElement {\n\n\n    static get observedAttributes() {\n        return [\n            'name',\n            'value'\n        ];\n    }\n    constructor() {\n        super();\n        this.root = this.attachShadow({ mode: 'open' });\n    }\n\n    connectedCallback(){\n        let session = this._getParentSession();\n        session.setData(this.name, this.value);\n    };\n\n\n}\n\n\nif (!customElements.get('aa-variable')) {\n    window.AANodeNames = window.AANodeNames|| []; \n    window.AANodeNames.push('AA-VARIABLE');\n    customElements.define('aa-variable', AAVariable);\n}\n","import BaseElement from '../aa-baseElement/baseElement.js';\n\nexport default class AAFunctionRandom extends BaseElement {\n\n    static get observedAttributes() {\n        return ['name', 'debug', 'value', 'min', 'max'];\n    }\n    constructor(){\n        super();\n    }\n\n    connectedCallback(){\n        let session = this._getParentSession()\n        this.value = this.getValue();\n        session.setData(this.name, this.value);\n        this._dispatchEndEvent();\n    }\n\n    getValue()\n    {\n        var parsedMin = parseFloat(this.min);\n        var parsedMax = parseFloat(this.max);\n        return this.getRandomInt(parsedMin, parsedMax);\n    }\n\n    getRandomInt(min, max)\n    {\n        min = Math.ceil(min);\n        max = Math.floor(max);\n        return Math.floor(Math.random() * (max - min) + 0.5) + min;\n    }\n\n\n}\n\n\n\nif (!customElements.get('aa-function-random')) {\n    \n    window.AANodeNames = window.AANodeNames || [];\n    window.AANodeNames.push('AA-FUNCTION-RANDOM');\n    customElements.define('aa-function-random', AAFunctionRandom);\n}\n","import BaseElement from './../aa-baseElement/baseElement.js'\n\n\n\nexport default class AAMemory extends BaseElement {\n\n    get observedAttributes(){\n        return [\"name\"];\n    }\n\n    constructor(){\n        super();\n    }\n\n    connectedCallback(){\n        \n    }\n\n    setData(name,value){\n        this.dataset[name] = value;\n    }\n\n    getData(name){\n        return this.dataset[this.toHyphenated(name)];\n    }\n}\n\n\nif (!customElements.get('aa-memory')) {\n\n    if (typeof window.AANodeNames ===\"undefined\") { \n        window.AANodeNames = []; \n    }\n    window.AANodeNames.push(\"AA-MEMORY\");\n    customElements.define('aa-memory', AAMemory);\n}","import BaseElement from './../aa-baseElement/baseElement.js'\n\n\nexport default class AAScreen extends BaseElement {\n\n\n\n    static get observedAttributes() { \n        return [\n            'submit-button-text',\n            'submit-button-hidden',\n            'name'\n        ];\n    }\n\n    constructor() {        \n        super();\n        this.root = this.attachShadow({ mode: 'open' });\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this.submitButtonText = this._submitButtonText || 'submit';\n        this.root.innerHTML = this.css + this.html;\n\n        if (this._started) { return; }\n        this._started = true;\n\n        if (this.submitButtonHidden) {\n            this.root.querySelector('.submitButtonContainer').style.display = 'none';\n        }\n\n\n        // if (typeof this.innerFragment != 'undefined') {\n        //     this._replaceChildNodesWithHolderElements(this.innerFragment);\n        //     this.appendChild(this.innerFragment);\n        //     this._restoreHeldNodes(this);\n        // }\n\n        this.root.querySelector('.submitButton').addEventListener('click', this.submitButtonClick.bind(this));\n\n    }\n\n\n    get css() {\n\n        return html`\n            <style>\n                :host {\n                    display: block;\n                    height: fit-content;\n                    border: solid thin;\n                }\n\n                .submitButtonContainer{\n                    display:flex; \n                    justify-content: space-between; \n                    align-items:center;\n                }\n            \n            </style>\n        `;\n    }\n\n    get html() {\n\n        return html`\n            <slot></slot>\n            \n            <div class='submitButtonContainer'>\n                <div>\n                    <button class='submitButton'> button: ${this.submitButtonText}</button>\n                </div>\n                <div id='userMessage'></div>\n            </div>\n        \n        `\n    }\n\n\n\n\n    attributeChangedCallback() {\n\n    }\n\n\n\n\n    hasChildrenThatDemandResponse() {\n\n        let emaChildren = this.getEmaChildren(this);\n        let result = false;\n        for (let i = 0; i < emaChildren.length; i++) {\n            let child = emaChildren[i];\n            if (child.demandsResponse) {\n                if (child.getValue() == null) {\n                    // console.log(child, 'demands response');\n\n                    if (child.displayAttention) {\n                        child.displayAttention();\n                    }\n\n                    result = true;\n                }\n            }\n        }\n        if (result) {\n            this.userMessage.innerHTML = `<div style=\"display:flex; align-items:center\"> <div>please fill out the required fields</div> <div id=\"attention\" style=\"color: red; font-size: 20px;  border: solid thin; border-radius: 50%; width: 20px;\n                                            margin-left:20px; height: 20px; \n                                            text-align: center;\n                                            padding: 5px;\">!</div></div>`\n            this.userMessage.style.color = 'red';\n        }\n        return result;\n    }\n\n\n    submitButtonClick(e) {\n\n\n\n\n        this.$.userMessage.innerHTML = '';\n\n        if (this.hasChildrenThatDemandResponse()) {\n            return;\n        }\n\n        //dispatch endEvent \n        let valueSubmitEvent = new CustomEvent('valueSubmit', { bubbles: true, detail: { value: this.getValue() } });\n        this.dispatchEvent(valueSubmitEvent);\n\n        this._dispatchEndEvent(this.getValue());\n        \n\n        if (typeof e.detail.callback != 'undefined') {\n            e.detail.callback(e);\n        }\n\n\n        //hide the screen\n\n        if (this.dontHide == false) this.hide();\n\n    }\n\n\n    getChildrenValuesOrder(element) {\n        if (typeof element === 'undefined') element = this;\n        var emaChildren = this.getEmaChildren(element);\n        var result = [];\n        for (var i = 0; i < emaChildren.length; i++) {\n            var child = emaChildren[i]\n            if (typeof this.name != 'undefined') {\n                result.push(this.name + '$' + child.getName());\n            }\n            else {\n                result.push(child.getName());\n            }\n        }\n    }\n\n\n\n    getValue() {\n        var __meta = {\n            attachedTimestamp: this.attachedTimestamp,\n            submitTimestamp: new Date().getTime()\n        }\n        var result = this.getChildrenValues(this);\n        return result;\n    }\n\n    getValueWithKey() {\n        var result = {}\n        result[this.name] = this.getValue();\n        return result;\n    }\n\n\n    automate() {\n        for (var i = 0; i < this.children.length; i++) {\n            if (this.isEmaElement(this.children[i])) {\n                if (typeof this.children[i].automate != 'undefined') {\n                    this.children[i].automate();\n                }\n            }\n        }\n        this.submitButtonClick();\n    }\n\n\n    hide() {\n        this.style.display = 'none'\n\n    }\n\n    show() {\n        this.style.display = 'block'\n        //this.removeAttribute('hidden');\n    }\n\n\n}\n\n\nif (!customElements.get('aa-screen')) {\n    window.AANodeNames = window.AANodeNames || [];\n    window.AANodeNames.push('AA-SCREEN');\n    customElements.define('aa-screen', AAScreen);\n}\n","import BaseElement from \"../../aa-baseElement/baseElement.js\";\n\nexport default class AAJump extends BaseElement {\n\n    static get observedAttributes() {\n        return [\"name\", \"goto\"]\n    }\n\n    connectedCallback() {\n        this.dispatchEvent(new CustomEvent(\"endEvent\", {\n            bubbles: true, \n            detail: {\n                goto: this.goto\n            }\n        }))\n    }\n}\n\n\nif (!customElements.get('aa-jump')) {\n    window.AANodeNames = window.AANodeNames || [];\n    window.AANodeNames.push('AA-JUMP');\n    customElements.define('aa-jump', AAJump);\n}","import BaseElement from './../aa-baseElement/baseElement.js'\nimport AAFunctionRandom from '../aa-function/aa-function-random.js';\nimport AAJump from \"./aa-jump/aa-jump.js\";\nimport AAHolder from '../aa-holder/aa-holder.js';\n\n\nexport default class AASequence extends BaseElement {\n\n\n    static get observedAttributes() {\n        return ['name', 'write-into', 'should-run', 'debug', 'type', \"stopped\"];\n    }\n\n    constructor() {\n        super();\n        this.root = this.attachShadow({ mode: 'open' });\n        this.root.innerHTML = '<slot></slot>';\n    }\n    connectedCallback() {\n\n\n        this.root.addEventListener(\"endEvent\", this.endEventListener.bind(this));\n        // if (this.id === '') console.warn(this, 'has no id');\n\n        // console.log('ready sequence', this.name);\n        this.started = false;\n\n        if ((this.shouldRun === null) || (this.shouldRun === true)) {\n\n            this.init()\n        };\n\n\n\n    }\n\n\n    get css() {\n        return html`\n            <style>\n                :host {\n                    display: block;\n                }\n            </style>\n        `\n    }\n\n    get html() {\n        return html`\n            <slot></slot>\n            <button id='nextButton' hidden></button>\n        `\n\n    }\n\n\n\n\n    properties() {\n\n        return {\n            shouldRun: {\n                type: Boolean,\n                value: true,\n                reflectToAttribute: false,\n                reflectToConfig: false\n            },\n\n            showNextButton: {\n                type: Boolean,\n                value: false\n            },\n\n            nextKeyCode: {\n                type: Number,\n                value: 0\n            },\n\n            prevKeyCode: {\n                type: Number,\n                value: 0\n            },\n\n            displayAll: {\n                type: Boolean,\n                value: false\n            }\n        }\n    }\n\n\n\n\n\n    \n\n\n    init() {\n\n        if (this.writeInto) {\n            this.target = document.querySelector(this.writeInto);\n        } else {\n            this.target = this;\n        }\n\n        if (this.started) return;\n\n        if (typeof this.innerFragment === 'undefined') {\n            console.warn('.innerFragment is undefined');\n            this.restoreHeldNodes(this)\n            return;\n        }\n        else {\n\n        }\n        debugger;\n        \n        this.sIndex = 0;\n        this.formerNodes = [];\n        this.formerIndex = 0;\n        this.nextCalls = [true];\n        this.nextIndex = 0;\n\n        if (!this.stopped) { start() }\n    }\n\n    start() {\n        debugger;\n        if(this.started){return;}\n        this.started=true;\n        this.nextWithTimeout(this.hasNext())\n    }\n\n    stop() {\n        this.stopped = true;\n        this.started = false;\n        debugger;\n    }\n\n    nextWithTimeout(name){\n        setTimeout(()=>{\n            this.next(name);\n            let nextParam = this.hasNext()\n            if(nextParam){\n                this.nextWithTimeout(nextParam)\n            }else{\n                if(nextParam==null){\n                        this._dispatchEndEvent();        \n                }\n            }\n        },0);\n    }\n\n\n    next(name) {\n\n        if (!this.counter) {\n            this.counter = 1;\n        } else {\n            this.counter++;\n            // if (this.counter > 500) {\n            //     return null;\n            // }\n        }\n\n\n        if (this.sIndex >= this.innerFragment.childNodes.length) return null;\n\n        if (typeof name === \"string\") {\n            for (let i = 0; i < this.innerFragment.childNodes.length; i++) {\n                // console.log(this.innerFragment.childNodes[i]);\n                // \n                if (this.innerFragment.childNodes[i].getAttribute) if (this.innerFragment.childNodes[i].getAttribute(\"name\") == name) {\n                    this.sIndex = i;\n                    break;\n                }\n            }\n\n        }\n\n\n        let fragmentChild = this.innerFragment.childNodes[this.sIndex];\n        // \n        if (this.type === \"elements\") {\n            if (fragmentChild.nodeType != Node.ELEMENT_NODE) {\n                this.nextCalls.push(true);\n                this.sIndex += 1;\n                console.log(\"rejecting\", fragmentChild);\n                return;\n            }\n        }\n        let fragmentChildCopy = this.copy(fragmentChild);\n\n        // console.log(this.innerFragment.childNodes);\n        // console.log(fragmentChildCopy);\n        this.formerNodes.push(fragmentChildCopy);\n        console.log(\"original\", fragmentChild);\n        console.log(\"copy\", fragmentChildCopy);\n        this.sIndex += 1;\n\n\n\n        let n = this.formerNodes[this.formerIndex];\n        // \n        this.target.appendChild(n);\n        this.formerIndex++;\n        AAHolder.scanAndRestore(this.target.childNodes[this.childNodes.length - 1]);\n        if (!n._dispatchEndEvent) {\n            this.nextCalls.push(true);\n        } else {\n            // this.nextCalls.push(false);\n\n        }\n\n        setTimeout(() => { }, 0);\n\n    }\n\n\n    hasNext() {\n        if (this.nextCalls.length > 10000) return null;\n        if (this.started === false) return null;\n        console.log(this.nextCalls);\n        if (this.nextIndex < this.nextCalls.length) {\n            let val = this.nextCalls[this.nextIndex];\n            this.nextIndex++;\n            return val;\n        } else\n            return null;\n    }\n\n\n    endEventListener(e) {\n\n        e.stopPropagation();\n        let goto = null\n        if (e.detail) {\n            if (e.detail.goto) {\n\n                goto = e.detail.goto;\n                this.nextCalls.push(goto);\n            } else {\n                this.nextCalls.push(true);\n            }\n        } else {\n            this.nextCalls.push(true);\n        }\n\n        if (!this.nextCalls[this.nextIndex]) {\n            \n                this.nextWithTimeout(this.hasNext())\n\n        }\n    }\n}\n\n\n\n\nif (!customElements.get('aa-sequence')) {\n\n    if (typeof window.AANodeNames === 'undefined') { window.AANodeNames = []; }\n    window.AANodeNames.push('AA-SEQUENCE');\n\n    customElements.define('aa-sequence', AASequence);\n\n\n}\n\n","import BaseElement from './../aa-baseElement/baseElement.js'\nimport AAHolder from  '../aa-holder/aa-holder.js';\nimport  './../aa-memory/aa-memory.js'\n\nexport default class AASession extends BaseElement {\n\n\n    static get observedAttributes() {\n        return ['name', 'should-run', 'debug'];\n    }\n\n\n\n    constructor() {\n        super();\n        this._mem = document.createElement('aa-memory');\n\n        this.myTemplate = document.createElement('template');\n        this.myTemplate.innerHTML = this.innerHTML;\n        this.innerHTML = '';\n\n        // this.root = this.attachShadow({ mode: 'closed' });\n        // this.root.innerHTML = '<template><slot></slot></template>'\n\n        this.addEventListener('valueSubmit', (e) => {\n\n\n            // e.stopPropagation();\n            let input = {\n                data: e.detail.value,\n                sessionID: this.sessionID,\n                sessionTimestamp: this.sessionTime,\n                sessionName: this.name,\n                variables: Object.keys(e.detail.value),\n            };\n            this._mem.saveReplyValue(e.detail.value, false);\n\n\n            let inputSubmitEvent = new CustomEvent('inputSubmit', { bubbles: true, detail: { input } });\n            this.dispatchEvent(inputSubmitEvent);\n            //  ema-participant-client needs to catch this and either send it to the server,\n            //  or store it locally if we are offline\n            //  A reason that ema-participant-client needs to do this, is because it cares\n            //  about identification tokens\n\n\n        })\n\n        this.addEventListener('endEvent', (e) => {\n            if(!this.debug) e.stopPropagation();\n            let sessionEndEvent = new CustomEvent('sessionEndEvent', { bubbles: true, detail: 'sessionEnd' });\n            this.dispatchEvent(sessionEndEvent);\n        })\n\n\n    }\n\n    myIdGenerator() {\n\n        return 0;\n    }\n\n    connectedCallback() {\n\n        this.sessionID = this.myIdGenerator();\n        this.sessionTime = new Date().getTime();\n        let sessionDatum = Object.keys(this.dataset);\n        for(let i in sessionDatum){\n            this.setData(sessionDatum[i], this.dataset[sessionDatum[i]]);\n        }\n        if ((this.shouldRun === null) || (this.shouldRun === true)) {\n            this.run();\n        }\n    }\n\n\n    attachTemplateChildNodesToMyself(templateClone){\n        \n        while(templateClone.content.childNodes.length){\n            //  if there's a direct template child, we want its children appended too\n            if(templateClone.content.childNodes[0].nodeName===\"TEMPLATE\"){\n                while(templateClone.content.childNodes[0].content.childNodes.length){\n                    this.appendChild(templateClone.content.childNodes[0].content.childNodes[0])\n                }\n                //  we are not appending the template element elsewhere \n                //  so throw it way so that the childnode count can be reduced\n                templateClone.content.childNodes[0].remove();\n            }else{\n                this.appendChild(templateClone.content.childNodes[0]);\n            }\n        }\n    }\n\n    run() {\n    \n        let myTemplateClone = this.myTemplate.cloneNode(true);\n        AAHolder.scanAndReplace(myTemplateClone);   \n        this.attachTemplateChildNodesToMyself(myTemplateClone);\n        for(let i=0; i<this.childNodes.length; i++){\n            AAHolder.scanAndRestore(this.childNodes[i]);\n        }\n    }\n\n    getData(name){\n        return this._mem.getData(name);\n    }\n    setData(name, value){\n        return this._mem.setData(name, value);\n    }\n\n    getDataDump(){\n        return this._mem.dataset;\n    }\n\n}\n\n\n\n\nif (!customElements.get('aa-session')) {\n    window.AANodeNames = window.AANodeNames|| []; \n    window.AANodeNames.push('AA-SESSION');\n    customElements.define('aa-session', AASession);\n}\n\n\n\n\n\n\n","import BaseElement from './aa-baseElement/baseElement.js';\nimport AAVariable from './aa-variable/aa-variable.js';\nimport AAFunctionRandom from \"./aa-function/aa-function-random.js\"\nimport AAChoose from './aa-choose/aa-choose.js';\nimport AAHolder from './aa-holder/aa-holder.js';\nimport AAMemory from './aa-memory/aa-memory.js';\nimport AAScreen from './aa-screen/aa-screen.js';\nimport AASequence from './aa-sequence/aa-sequence.js';\nimport AASession from './aa-session/aa-session.js';\n//make sure session loads last\n\n\n\nlet aaCustomElements = {\n    BaseElement,\n    AAChoose,\n    AAMemory,\n    AAScreen,\n    AASequence,\n    AASession,\n    AAVariable,\n    AAHolder,\n    // __VERSION: VERSION,\n    // __BUILD_NUMBER: BUILD_NUMBER,\n    // // __BUILD_BRANCH:BUILD_BRANCH,\n    // __BUILD_STRING: BUILD_STRING\n\n}\n\nif(window){\n    window.aaCustomElements = aaCustomElements\n}\n// export default aaCustomElements;"],"sourceRoot":""}